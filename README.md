# PentestWithGrep


## Documentation

This script is a Bash script designed for penetration testing (PenTesting) using the `grep` command-line tool in a UNIX-like environment. It automates the process of searching through a specified directory for specific patterns that might indicate security vulnerabilities or bad practices in the code. Hereâ€™s a breakdown of how the script works:

 Header and Usage
```bash
!/bin/bash

 Pentest with UNIX grep tool...
 ---------------------------------
 Simple script for PenTesting.
```
- The first line (`#!/bin/bash`) specifies that the script should be run using the Bash shell.
- The comments provide context about what the script does.

Argument Check
```bash
if [ $# -ne 1 ]
then
  echo "Usage: `basename $0` directory-to-grep-through"
  exit 0
fi
```
- This checks if the script was called with exactly one argument (the directory to search through). If not, it prints a usage message and exits.

Options and Variables
```bash
ADDITIONAL_GREP_ARGUMENTS="-A 1 -B 3 --color=always"
TARGET="./grep-output"

DO_JAVA=true
DO_SPRING=true
DO_JSP=true
DO_ANDROID=true
DO_IOS=true
DO_PHP=true
DO_GENERAL=true
```
- Sets additional arguments for `grep` that modify its behavior, such as showing lines before/after matches (`-A 1 -B 3`) and enabling color output.
- Defines a target directory (`./grep-output`) where the results will be stored.
- Flags for different programming languages or frameworks (Java, Spring, JSP, Android, iOS, PHP, and general patterns) are set to true, indicating that the script will execute searches for these categories.

Preparing Grep Arguments
```bash
GREP_ARGUMENTS="-nrP"
STANDARD_GREP_ARGUMENTS=$ADDITIONAL_GREP_ARGUMENTS" "$GREP_ARGUMENTS
SEARCH_FOLDER=$1
mkdir $TARGET
```
- Sets `grep` options:
  - `-n`: Show line numbers.
  - `-r`: Recursive search.
  - `-P`: Use Perl-compatible regular expressions.
- Combines the additional and standard `grep` arguments.
- Gets the search folder from the first argument and creates the target output directory.

Search Operations
The script then performs a series of searches based on the flags set earlier. Each block checks if the corresponding flag is set to `true` and performs searches accordingly.

Example of a Search Block:
```bash
if [ $DO_JAVA ]; then
    SEARCH_STRING='javax.crypto|bouncy.*?castle|new\sSecretKeySpec\(|messagedigest'
    OUTFILE="java_general_crypto.txt"
    echo "Searching for $SEARCH_STRING --> writing to $OUTFILE"
    grep -i $STANDARD_GREP_ARGUMENTS "$SEARCH_STRING" "$SEARCH_FOLDER" > $TARGET/$OUTFILE
```
- Checks if the `DO_JAVA` flag is `true`.
- Defines a search string (using regular expressions) that looks for specific Java-related patterns.
- Sets an output file name.
- Executes the `grep` command with the defined search string and writes the output to the specified file in the target directory.

This pattern repeats for various categories, including:
- Java vulnerabilities (like cryptographic methods, wrong string comparisons, etc.)
- Spring framework issues (mass assignment vulnerabilities).
- JSP-related security risks (like XSS).
- Android and iOS security concerns (file access, network security).
- PHP security issues (like handling user inputs).
- General security checks (like detecting sensitive information, potential exploits, etc.).

Final Output:
```bash
echo "Done grep. Results in $TARGET."
```
- After all searches are completed, the script prints a message indicating that the process is finished and where to find the results.


#### Known Bugs:
1. Directory Creation Failure: If the `TARGET` directory already exists, the script may fail without warning.
2. Unconditional Execution: Variables like `DO_JAVA` are always set to true; thus, all checks execute regardless of user preferences.
3. Output Overwriting: Each run overwrites previous outputs without prompting for confirmation.
4. Lack of Error Handling: There is no error handling for `grep` failures or invalid directory paths.
5. Regex Limitations: Some regex patterns may not work as intended due to shell interpretation of special characters.






Bash Script 	![Bash Script](https://img.shields.io/badge/bash_script-%23121011.svg?style=for-the-badge&logo=gnu-bash&logoColor=white)



